client_rank:2
start
before init
after init
{'model_type': 'GMF', 'dataset_type': 'CIFAR10', 'batch_size': 48, 'data_pattern': 0, 'lr': 0.001, 'decay_rate': 0.99, 'min_lr': 0.001, 'epoch': 5, 'momentum': -1, 'weight_decay': 0.0, 'para': {'item_embeddings.weight': tensor([[ 0.0080,  0.0197,  0.0016,  ..., -0.0101, -0.0036, -0.0015],
        [-0.0053,  0.0082,  0.0129,  ...,  0.0143,  0.0008, -0.0078],
        [-0.0127, -0.0116, -0.0059,  ..., -0.0068, -0.0042, -0.0171],
        ...,
        [ 0.0123, -0.0140, -0.0061,  ..., -0.0182, -0.0080, -0.0146],
        [ 0.0095,  0.0047, -0.0322,  ...,  0.0013,  0.0120,  0.0097],
        [-0.0058,  0.0091,  0.0162,  ...,  0.0014, -0.0059,  0.0027]]), 'predict_layer.weight': tensor([[-0.0121,  0.1574, -0.3039,  0.1238, -0.2623,  0.3432,  0.3381,  0.2176]]), 'predict_layer.bias': tensor([-0.1440])}, 'data_path': '/data/docker/data', 'tag': 1}
epoch-1 lr: 0.001
tensor([[ 0.0080,  0.0197,  0.0016,  0.0041,  0.0051, -0.0101, -0.0036, -0.0015],
        [-0.0053,  0.0082,  0.0129, -0.0010, -0.0115,  0.0143,  0.0008, -0.0078],
        [-0.0127, -0.0116, -0.0059, -0.0079,  0.0173, -0.0068, -0.0042, -0.0171],
        [ 0.0014,  0.0074, -0.0091,  0.0127,  0.0036,  0.0020,  0.0002, -0.0039],
        [-0.0124,  0.0089, -0.0059,  0.0079, -0.0141,  0.0100,  0.0124, -0.0133],
        [-0.0028,  0.0047, -0.0046, -0.0046, -0.0066, -0.0032, -0.0134, -0.0142],
        [-0.0007, -0.0072,  0.0135, -0.0017,  0.0003,  0.0098,  0.0046, -0.0003],
        [-0.0008,  0.0109, -0.0047, -0.0076, -0.0213, -0.0004,  0.0101,  0.0033],
        [ 0.0109, -0.0032, -0.0101,  0.0079, -0.0097, -0.0012, -0.0068,  0.0106],
        [ 0.0128, -0.0034,  0.0036,  0.0045, -0.0035,  0.0015, -0.0055, -0.0060]])
after aggregation, epoch: 1, train loss: 0.652099996805191, HR: 0.09834437086092715, NDCG: 0.04477268531943676
send para
after send
get end
epoch-2 lr: 0.001
tensor([[ 8.0358e-03,  1.9680e-02,  1.6134e-03,  4.1395e-03,  5.0829e-03,
         -1.0126e-02, -3.6161e-03, -1.5383e-03],
        [-6.1034e-03,  7.4159e-03,  1.2102e-02, -1.9275e-04, -1.2348e-02,
          1.5086e-02, -3.4894e-05, -6.9374e-03],
        [-1.2691e-02, -1.1563e-02, -5.8526e-03, -7.9115e-03,  1.7313e-02,
         -6.8130e-03, -4.1782e-03, -1.7060e-02],
        [ 1.3512e-03,  7.4135e-03, -9.0643e-03,  1.2712e-02,  3.6466e-03,
          1.9715e-03,  2.4311e-04, -3.8951e-03],
        [-1.2381e-02,  8.9396e-03, -5.9005e-03,  7.8547e-03, -1.4125e-02,
          9.9641e-03,  1.2382e-02, -1.3306e-02],
        [-2.8124e-03,  4.6955e-03, -4.6414e-03, -4.5604e-03, -6.5552e-03,
         -3.2269e-03, -1.3353e-02, -1.4212e-02],
        [-6.8042e-04, -7.2463e-03,  1.3462e-02, -1.7349e-03,  3.0218e-04,
          9.7867e-03,  4.5708e-03, -3.4915e-04],
        [-7.9912e-04,  1.0893e-02, -4.6976e-03, -7.5549e-03, -2.1267e-02,
         -3.5706e-04,  1.0063e-02,  3.2980e-03],
        [ 1.0886e-02, -3.2295e-03, -1.0095e-02,  7.8897e-03, -9.7000e-03,
         -1.2471e-03, -6.8125e-03,  1.0587e-02],
        [ 1.2835e-02, -3.4383e-03,  3.5802e-03,  4.4795e-03, -3.4906e-03,
          1.4592e-03, -5.5090e-03, -6.0450e-03]])
after aggregation, epoch: 2, train loss: 0.643942803144455, HR: 0.09834437086092715, NDCG: 0.04489131781212031
send para
after send
get end
epoch-3 lr: 0.001
tensor([[ 8.0358e-03,  1.9680e-02,  1.6134e-03,  4.1395e-03,  5.0829e-03,
         -1.0126e-02, -3.6161e-03, -1.5383e-03],
        [-6.1034e-03,  7.4159e-03,  1.2102e-02, -1.9275e-04, -1.2348e-02,
          1.5086e-02, -3.4894e-05, -6.9374e-03],
        [-1.2691e-02, -1.1563e-02, -5.8526e-03, -7.9115e-03,  1.7313e-02,
         -6.8130e-03, -4.1782e-03, -1.7060e-02],
        [ 1.3512e-03,  7.4135e-03, -9.0643e-03,  1.2712e-02,  3.6466e-03,
          1.9715e-03,  2.4311e-04, -3.8951e-03],
        [-1.2381e-02,  8.9396e-03, -5.9005e-03,  7.8547e-03, -1.4125e-02,
          9.9641e-03,  1.2382e-02, -1.3306e-02],
        [-2.8124e-03,  4.6955e-03, -4.6414e-03, -4.5604e-03, -6.5552e-03,
         -3.2269e-03, -1.3353e-02, -1.4212e-02],
        [-6.8042e-04, -7.2463e-03,  1.3462e-02, -1.7349e-03,  3.0218e-04,
          9.7867e-03,  4.5708e-03, -3.4915e-04],
        [-7.9912e-04,  1.0893e-02, -4.6976e-03, -7.5549e-03, -2.1267e-02,
         -3.5706e-04,  1.0063e-02,  3.2980e-03],
        [ 1.0886e-02, -3.2295e-03, -1.0095e-02,  7.8897e-03, -9.7000e-03,
         -1.2471e-03, -6.8125e-03,  1.0587e-02],
        [ 1.2835e-02, -3.4383e-03,  3.5802e-03,  4.4795e-03, -3.4906e-03,
          1.4592e-03, -5.5090e-03, -6.0450e-03]])
after aggregation, epoch: 3, train loss: 0.6541352272033691, HR: 0.09834437086092715, NDCG: 0.04477088524667417
send para
after send
get end
epoch-4 lr: 0.001
tensor([[ 8.0358e-03,  1.9680e-02,  1.6134e-03,  4.1395e-03,  5.0829e-03,
         -1.0126e-02, -3.6161e-03, -1.5383e-03],
        [-6.1034e-03,  7.4159e-03,  1.2102e-02, -1.9275e-04, -1.2348e-02,
          1.5086e-02, -3.4894e-05, -6.9374e-03],
        [-1.2691e-02, -1.1563e-02, -5.8526e-03, -7.9115e-03,  1.7313e-02,
         -6.8130e-03, -4.1782e-03, -1.7060e-02],
        [ 1.3512e-03,  7.4135e-03, -9.0643e-03,  1.2712e-02,  3.6466e-03,
          1.9715e-03,  2.4311e-04, -3.8951e-03],
        [-1.2381e-02,  8.9396e-03, -5.9005e-03,  7.8547e-03, -1.4125e-02,
          9.9641e-03,  1.2382e-02, -1.3306e-02],
        [-2.8124e-03,  4.6955e-03, -4.6414e-03, -4.5604e-03, -6.5552e-03,
         -3.2269e-03, -1.3353e-02, -1.4212e-02],
        [-6.8042e-04, -7.2463e-03,  1.3462e-02, -1.7349e-03,  3.0218e-04,
          9.7867e-03,  4.5708e-03, -3.4915e-04],
        [-7.9912e-04,  1.0893e-02, -4.6976e-03, -7.5549e-03, -2.1267e-02,
         -3.5706e-04,  1.0063e-02,  3.2980e-03],
        [ 1.0886e-02, -3.2295e-03, -1.0095e-02,  7.8897e-03, -9.7000e-03,
         -1.2471e-03, -6.8125e-03,  1.0587e-02],
        [ 1.2835e-02, -3.4383e-03,  3.5802e-03,  4.4795e-03, -3.4906e-03,
          1.4592e-03, -5.5090e-03, -6.0450e-03]])
after aggregation, epoch: 4, train loss: 0.6379879415035248, HR: 0.09602649006622517, NDCG: 0.044143452914355646
send para
after send
get end
epoch-5 lr: 0.001
tensor([[ 8.3980e-03,  2.0052e-02,  1.9853e-03,  3.7677e-03,  4.7115e-03,
         -9.7551e-03, -3.2485e-03, -1.9101e-03],
        [-6.1034e-03,  7.4159e-03,  1.2102e-02, -1.9275e-04, -1.2348e-02,
          1.5086e-02, -3.4894e-05, -6.9374e-03],
        [-1.2691e-02, -1.1563e-02, -5.8526e-03, -7.9115e-03,  1.7313e-02,
         -6.8130e-03, -4.1782e-03, -1.7060e-02],
        [ 1.3512e-03,  7.4135e-03, -9.0643e-03,  1.2712e-02,  3.6466e-03,
          1.9715e-03,  2.4311e-04, -3.8951e-03],
        [-1.2381e-02,  8.9396e-03, -5.9005e-03,  7.8547e-03, -1.4125e-02,
          9.9641e-03,  1.2382e-02, -1.3306e-02],
        [-2.8124e-03,  4.6955e-03, -4.6414e-03, -4.5604e-03, -6.5552e-03,
         -3.2269e-03, -1.3353e-02, -1.4212e-02],
        [-6.8042e-04, -7.2463e-03,  1.3462e-02, -1.7349e-03,  3.0218e-04,
          9.7867e-03,  4.5708e-03, -3.4915e-04],
        [-7.9912e-04,  1.0893e-02, -4.6976e-03, -7.5549e-03, -2.1267e-02,
         -3.5706e-04,  1.0063e-02,  3.2980e-03],
        [ 1.0886e-02, -3.2295e-03, -1.0095e-02,  7.8897e-03, -9.7000e-03,
         -1.2471e-03, -6.8125e-03,  1.0587e-02],
        [ 1.2835e-02, -3.4383e-03,  3.5802e-03,  4.4795e-03, -3.4906e-03,
          1.4592e-03, -5.5090e-03, -6.0450e-03]])
after aggregation, epoch: 5, train loss: 0.6420949399471283, HR: 0.09735099337748344, NDCG: 0.044506201919967514
send para
after send
get end
